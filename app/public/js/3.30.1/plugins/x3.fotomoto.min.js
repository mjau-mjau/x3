/* www.photo.gallery X3.30.1 / x3.fotomoto.min.js / 2021-02-27 */
var fotomoto_go;!function(){var o,t,e,n,l,c,m,r=!1,d=!1,f=x3_settings.plugins.fotomoto,u=f.store_id.trim(),p=!1,h=!1,_=x3_tests.local_storage,b=_&&localStorage.getItem("fotomoto_items")?Number(localStorage.getItem("fotomoto_items")):0,O="yes"===f.buy_button_popup||"mobile"===f.buy_button_popup&&x3_tests.mobile;function y(o){return"x3.locl"===location.hostname?"https://demo.photo.gallery"+o.replace("/x3",""):location.protocol+"//"+location.hostname+o}function v(o){var t=o.dataset.image;if(t)return t;var e=o.closest("[data-image]");return e?e.dataset.image:void 0}function x(){if(m.length){var o=m.find("a.item");if(o.length){var t=[];o.each((function(){var o=v(this);if(o){var e={img:y(o)};h&&(e.collection=h),t.push(e)}})),t.length&&(L("Fotomoto / images:",t),$.post("https://widget.fotomoto.com/stores/photo_checkin",{store_key:u,page_url:x3_settings.canonical,imgs:t},(function(o){L("Fotomoto / data: "+o)}),"json"))}}}function T(){var o=f.collection.toLowerCase();$.each(p,(function(t,e){if(e.key.toLowerCase()===o||e.name.toLowerCase()===o)return h=e.key,!1})),h?x():I("Fotomoto collection ID/Name does not exist in your account:<br><strong>"+o+"</strong>")}function F(o){var e=o.dataset.description||"";e&&-1!==e.indexOf("fotomoto-buy")||(o.dataset.description=(e?e+'<br class="fotomoto-hide">':"")+t)}function I(o){Me('<div class="text-center"><p class="fa fa-warning fa-5x" style="color:#d9534f;display:block;"></p>'+o+"</div>"),l.remove()}function C(){b=FOTOMOTO.API.getTotalItems(),FOTOMOTO.API.isBasketEmpty()?l.removeClass("has-items"):(l.addClass("has-items"),g(l,"pulse",300)),c.text(b),_&&localStorage.setItem("fotomoto_items",b)}fotomoto_go=function(s,c,g){f=x3_settings.plugins.fotomoto,O="yes"===f.buy_button_popup||"mobile"===f.buy_button_popup&&x3_tests.mobile;var _=' class="button small fotomoto-buy button-buy">'+f.buy_button_text.trim();o="<button"+_+"</button>",t="<a"+_+"</a>",m=s,e=c,(n=g)&&e.data("fotomoto-collection")&&(f.collection=e.data("fotomoto-collection").trim()),r||d||(r=!0,a.addClass("fotomoto-loading"),(l=Qt("fotomoto",!0)).addClass("loading"),window.fotomoto_cart_loaded=C,$.ajax({url:"https://widget.fotomoto.com/stores/script/"+u+".js?api=true",dataType:"script",cache:!0}).done((function(){if("undefined"==typeof FOTOMOTO_CONFIG){var o=40!==u.length?"<p><em>Fotomoto store ID should be 40 characters!</em></p>":"<p><em>Did you enable domain <strong>"+location.hostname+"</strong> in Fotomoto?</em></p>";I("<p>Failed to load Fotomoto script for store ID:<br><strong>"+u+"</strong></p>"+o)}})).fail((function(){I("<p>Failed to load Fotomoto script.</p>")}))),function(){if(n){var t=e.find(".gallery"),a=t.siblings(".back"),s=t.find("a.item");e.attr("data-image",t.children(".item").data("image")),a.length&&e.hasClass("file-fotomoto-buybutton")&&0===e.find(".fotomoto-buy").length&&(a.before(o),e.find(".fotomoto-buy").addClass("file-fotomoto-button")),F(s[0])}else if(f.enabled_page&&f.buy_button&&m.length){var l=m.find("a.item");l.length&&(m.hasClass("layout-slideshow")?O||l.each((function(){var t=$(this).children("span");0===t.find(".fotomoto-buy").length&&t.append("<br>"+o)})):(x3_settings.gallery.caption.enabled||x3_tests.mobile||O||m.addClass("caption-hover").removeClass("hover"),l.each((function(){var t=$(this);if(F(this),!O){var e=t.children("figure"),a=e.children("figcaption");a.length?0===a.find(".fotomoto-buy").length&&a.append(o):e.append('<figcaption itemprop="caption description" class="fotomoto-caption">'+o+"</figcaption>")}}))))}}(),h=!1,(f.enabled_page||n)&&(f.collection?p&&T():x())},window.fotomoto_loaded=function(){d=!0,r=!1,a.removeClass("fotomoto-loading").addClass("fotomoto-loaded"),l.removeClass("loading").toggleClass("has-items",b>0).prepend('<b class="total-items">'+b+"</b>"),c=l.children(".total-items"),l.on("click",(function(o){FOTOMOTO.API.isBasketEmpty()?x3_tests.mobile&&Me('<h3 class=text-center><i class="fa fa-exclamation-circle"></i> &nbsp;Cart is empty</h3>'):(a.addClass("fotomoto-widget-open"),FOTOMOTO.API.checkout())})),_&&setTimeout((function(){localStorage.setItem("fotomoto_items",FOTOMOTO.API.getTotalItems())}),3e3),FOTOMOTO.API.collectionList((function(o){L("Fotomoto / collectionList:",o),o&&$.isArray(o)&&o.length&&(p=o,f.collection&&T())})),s.on("click",".fotomoto-buy",(function(o){o.preventDefault(),o.stopImmediatePropagation();var t=v(this);if(t){var e=y(t);L("Fotomoto / img: "+e),h?(L("Fotomoto / collection_key: "+h),FOTOMOTO.API.checkinImage(e,(function(o){L("Fotomoto / checkinImage:",o)}),h)):FOTOMOTO.API.checkinImage(e),FOTOMOTO.API.showWindow(FOTOMOTO.API.PRINT,e),a.addClass("fotomoto-widget-open")}})),a.addClass("x3-checkout")},window.fotomoto_widget_closed=function(){C(),a.removeClass("fotomoto-widget-open")}}();