/* www.photo.gallery X3.29.6 / x3.fotomoto.min.js / 2020-07-08 */
var fotomoto_go;!function(){var t,e,a,n,l,c,r,d=!1,f=!1,g=x3_settings.plugins.fotomoto,p=g.store_id.trim(),u=!1,h=!1,_=x3_tests.local_storage,b=_&&localStorage.getItem("fotomoto_items")?Number(localStorage.getItem("fotomoto_items")):0,O="yes"===g.buy_button_popup||"mobile"===g.buy_button_popup&&x3_tests.mobile;function y(o){return"x3.locl"===location.hostname?"https://demo.photo.gallery"+o.replace("/x3",""):location.protocol+"//"+location.hostname+o}function x(){if(r.length){var o=r.find("a.item");if(o.length){var t=[];o.each((function(){var o=$(this),e=void 0!==o.data("image")?o.data("image"):o.closest("[data-image]").data("image");if(e){var a={img:y(e)};h&&(a.collection=h),t.push(a)}})),t.length&&(j("Fotomoto / images:",t),$.post("https://widget.fotomoto.com/stores/photo_checkin",{store_key:p,page_url:x3_settings.canonical,imgs:t},(function(o){j("Fotomoto / data: "+o)}),"json"))}}}function v(){var o=g.collection.toLowerCase();$.each(u,(function(t,e){if(e.key.toLowerCase()===o||e.name.toLowerCase()===o)return h=e.key,!1})),h?x():F("Fotomoto collection ID/Name does not exist in your account:<br><strong>"+o+"</strong>")}function T(o){var t=o.data("description")||"";-1===t.indexOf("fotomoto-buy")&&o.data("description",(t.length?t+'<br class="fotomoto-hide">':"")+e)}function F(o){Ie('<div class="text-center"><p class="fa fa-warning fa-5x" style="color:#d9534f;display:block;"></p>'+o+"</div>"),l.remove()}function I(){b=FOTOMOTO.API.getTotalItems(),FOTOMOTO.API.isBasketEmpty()?l.removeClass("has-items"):(l.addClass("has-items"),m(l,"pulse",300)),c.text(b),_&&localStorage.setItem("fotomoto_items",b)}fotomoto_go=function(s,c,m){g=x3_settings.plugins.fotomoto,O="yes"===g.buy_button_popup||"mobile"===g.buy_button_popup&&x3_tests.mobile;var _=' class="button small fotomoto-buy button-buy">'+g.buy_button_text.trim();t="<button"+_+"</button>",e="<a"+_+"</a>",r=s,a=c,(n=m)&&a.data("fotomoto-collection")&&(g.collection=a.data("fotomoto-collection").trim()),d||f||(d=!0,o.addClass("fotomoto-loading"),(l=Ht("fotomoto",!0)).addClass("loading"),window.fotomoto_cart_loaded=I,$.ajax({url:"https://widget.fotomoto.com/stores/script/"+p+".js?api=true",dataType:"script",cache:!0}).done((function(){if("undefined"==typeof FOTOMOTO_CONFIG){var o=40!==p.length?"<p><em>Fotomoto store ID should be 40 characters!</em></p>":"<p><em>Did you enable domain <strong>"+location.hostname+"</strong> in Fotomoto?</em></p>";F("<p>Failed to load Fotomoto script for store ID:<br><strong>"+p+"</strong></p>"+o)}})).fail((function(){F("<p>Failed to load Fotomoto script.</p>")}))),function(){if(n){var o=a.find(".gallery"),e=o.siblings(".back"),l=o.find("a.item");a.attr("data-image",o.children(".item").data("image")),e.length&&a.hasClass("file-fotomoto-buybutton")&&0===a.find(".fotomoto-buy").length&&(e.before(t),a.find(".fotomoto-buy").addClass("file-fotomoto-button")),T(l)}else if(g.enabled_page&&g.buy_button&&r.length){var s=r.find("a.item");s.length&&(r.hasClass("layout-slideshow")?O||s.each((function(){var o=$(this).children("span");0===o.find(".fotomoto-buy").length&&o.append("<br>"+t)})):(x3_settings.gallery.caption.enabled||x3_tests.mobile||O||r.addClass("caption-hover").removeClass("hover"),s.each((function(){var o=$(this);if(T(o),!O){var e=o.children("figure"),a=e.children("figcaption");a.length?0===a.find(".fotomoto-buy").length&&a.append(t):e.append('<figcaption itemprop="caption description" class="fotomoto-caption">'+t+"</figcaption>")}}))))}}(),h=!1,(g.enabled_page||n)&&(g.collection?u&&v():x())},window.fotomoto_loaded=function(){f=!0,d=!1,o.removeClass("fotomoto-loading").addClass("fotomoto-loaded"),l.removeClass("loading").toggleClass("has-items",b>0).prepend('<b class="total-items">'+b+"</b>"),c=l.children(".total-items"),l.on("click",(function(t){FOTOMOTO.API.isBasketEmpty()?x3_tests.mobile&&Ie('<h3 class=text-center><i class="fa fa-exclamation-circle"></i> &nbsp;Cart is empty</h3>'):(o.addClass("fotomoto-widget-open"),FOTOMOTO.API.checkout())})),_&&setTimeout((function(){localStorage.setItem("fotomoto_items",FOTOMOTO.API.getTotalItems())}),3e3),FOTOMOTO.API.collectionList((function(o){j("Fotomoto / collectionList:",o),o&&$.isArray(o)&&o.length&&(u=o,g.collection&&v())})),s.on("click",".fotomoto-buy",(function(t){var e=$(this);t.preventDefault(),t.stopImmediatePropagation();var a=void 0!==e.data("image")?e.data("image"):e.closest("[data-image]").data("image");if(a){var n="x3.locl"===location.hostname||(location.protocol,location.hostname);n=y(a);j("Fotomoto / img: "+n),h?(j("Fotomoto / collection_key: "+h),FOTOMOTO.API.checkinImage(n,(function(o){j("Fotomoto / checkinImage:",o)}),h)):FOTOMOTO.API.checkinImage(n),FOTOMOTO.API.showWindow(FOTOMOTO.API.PRINT,n),o.addClass("fotomoto-widget-open")}})),o.addClass("x3-checkout")},window.fotomoto_widget_closed=function(){I(),o.removeClass("fotomoto-widget-open")}}();