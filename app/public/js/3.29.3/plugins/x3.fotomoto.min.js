/* www.photo.gallery X3.29.3 / x3.fotomoto.min.js / 2020-06-25 */
var S;!function(){var t,e,a,i,l,s,c,m=!1,r=!1,d=x3_settings.plugins.fotomoto,g=d.store_id.trim(),p=!1,u=!1,h=x3_tests.local_storage,_=h&&localStorage.getItem("fotomoto_items")?Number(localStorage.getItem("fotomoto_items")):0,b="yes"===d.buy_button_popup||"mobile"===d.buy_button_popup&&x3_tests.mobile;function y(o){return"x3.locl"===location.hostname?"https://demo.photo.gallery"+o.replace("/x3",""):location.protocol+"//"+location.hostname+o}function x(){if(c.length){var o=c.find("a.item");if(o.length){var t=[];o.each((function(){var o=$(this),e=void 0!==o.data("image")?o.data("image"):o.closest("[data-image]").data("image");if(e){var a={img:y(e)};u&&(a.collection=u),t.push(a)}})),t.length&&(O("Fotomoto / images:",t),$.post("https://widget.fotomoto.com/stores/photo_checkin",{store_key:g,page_url:x3_settings.canonical,imgs:t},(function(o){O("Fotomoto / data: "+o)}),"json"))}}}function v(){var o=d.collection.toLowerCase();$.each(p,(function(t,e){if(e.key.toLowerCase()===o||e.name.toLowerCase()===o)return u=e.key,!1})),u?x():F("Fotomoto collection ID/Name does not exist in your account:<br><strong>"+o+"</strong>")}function T(o){var t=o.data("description")||"";-1===t.indexOf("fotomoto-buy")&&o.data("description",(t.length?t+'<br class="fotomoto-hide">':"")+e)}function F(o){Se('<div class="text-center"><p class="fa fa-warning fa-5x" style="color:#d9534f;display:block;"></p>'+o+"</div>"),l.remove()}function I(){_=FOTOMOTO.API.getTotalItems(),FOTOMOTO.API.isBasketEmpty()?l.removeClass("has-items"):(l.addClass("has-items"),f(l,"pulse",300)),s.text(_),h&&localStorage.setItem("fotomoto_items",_)}S=function(o,s,f){d=x3_settings.plugins.fotomoto,b="yes"===d.buy_button_popup||"mobile"===d.buy_button_popup&&x3_tests.mobile;var h=' class="button small fotomoto-buy button-buy">'+d.buy_button_text.trim();t="<button"+h+"</button>",e="<a"+h+"</a>",c=o,a=s,(i=f)&&a.data("fotomoto-collection")&&(d.collection=a.data("fotomoto-collection").trim()),m||r||(m=!0,n.addClass("fotomoto-loading"),(l=qt("fotomoto",!0)).addClass("loading"),window.fotomoto_cart_loaded=I,$.ajax({url:"https://widget.fotomoto.com/stores/script/"+g+".js?api=true",dataType:"script",cache:!0}).done((function(){if("undefined"==typeof FOTOMOTO_CONFIG){var o=40!==g.length?"<p><em>Fotomoto store ID should be 40 characters!</em></p>":"<p><em>Did you enable domain <strong>"+location.hostname+"</strong> in Fotomoto?</em></p>";F("<p>Failed to load Fotomoto script for store ID:<br><strong>"+g+"</strong></p>"+o)}})).fail((function(){F("<p>Failed to load Fotomoto script.</p>")}))),function(){if(i){var o=a.find(".gallery"),e=o.siblings(".back"),n=o.find("a.item");a.attr("data-image",o.children(".item").data("image")),e.length&&a.hasClass("file-fotomoto-buybutton")&&0===a.find(".fotomoto-buy").length&&(e.before(t),a.find(".fotomoto-buy").addClass("file-fotomoto-button")),T(n)}else if(d.enabled_page&&d.buy_button&&c.length){var l=c.find("a.item");l.length&&(c.hasClass("layout-slideshow")?b||l.each((function(){var o=$(this).children("span");0===o.find(".fotomoto-buy").length&&o.append("<br>"+t)})):(x3_settings.gallery.caption.enabled||x3_tests.mobile||b||c.addClass("caption-hover").removeClass("hover"),l.each((function(){var o=$(this);if(T(o),!b){var e=o.children("figure"),a=e.children("figcaption");a.length?0===a.find(".fotomoto-buy").length&&a.append(t):e.append('<figcaption itemprop="caption description" class="fotomoto-caption">'+t+"</figcaption>")}}))))}}(),u=!1,(d.enabled_page||i)&&(d.collection?p&&v():x())},window.fotomoto_loaded=function(){r=!0,m=!1,n.removeClass("fotomoto-loading").addClass("fotomoto-loaded"),l.removeClass("loading").toggleClass("has-items",_>0).prepend('<b class="total-items">'+_+"</b>"),s=l.children(".total-items"),l.on("click",(function(o){FOTOMOTO.API.isBasketEmpty()?x3_tests.mobile&&Se('<h3 class=text-center><i class="fa fa-exclamation-circle"></i> &nbsp;Cart is empty</h3>'):(n.addClass("fotomoto-widget-open"),FOTOMOTO.API.checkout())})),h&&setTimeout((function(){localStorage.setItem("fotomoto_items",FOTOMOTO.API.getTotalItems())}),3e3),FOTOMOTO.API.collectionList((function(o){O("Fotomoto / collectionList:",o),o&&$.isArray(o)&&o.length&&(p=o,d.collection&&v())})),o.on("click",".fotomoto-buy",(function(o){var t=$(this);o.preventDefault(),o.stopImmediatePropagation();var e=void 0!==t.data("image")?t.data("image"):t.closest("[data-image]").data("image");if(e){var a="x3.locl"===location.hostname||(location.protocol,location.hostname);a=y(e);O("Fotomoto / img: "+a),u?(O("Fotomoto / collection_key: "+u),FOTOMOTO.API.checkinImage(a,(function(o){O("Fotomoto / checkinImage:",o)}),u)):FOTOMOTO.API.checkinImage(a),FOTOMOTO.API.showWindow(FOTOMOTO.API.PRINT,a),n.addClass("fotomoto-widget-open")}})),n.addClass("x3-checkout")},window.fotomoto_widget_closed=function(){I(),n.removeClass("fotomoto-widget-open")}}();